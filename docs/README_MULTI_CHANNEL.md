# Job Notification Bot - Multi-Channel Edition 🚀

> Telegram userbot для мониторинга вакансий с веб-интерфейсом управления

## ✨ Новые возможности

### 🎯 Множественные каналы уведомлений
- Создавайте несколько output каналов для разных типов вакансий
- Каждый канал имеет свои источники и фильтры
- Одно сообщение может быть отправлено в несколько каналов одновременно

### 🌐 Веб-интерфейс
- Простое управление каналами через браузер
- Создание, редактирование и удаление каналов
- Статистика в реальном времени
- Интуитивный дизайн

### 🎛️ Гибкие фильтры
- Включающие ключевые слова (OR логика)
- Исключающие ключевые слова
- Настройка для каждого канала индивидуально

### 📊 Мониторинг
- Отслеживание множественных источников
- Автоматическое дедублицирование
- Логирование всех действий

## 🏗️ Архитектура

```
┌──────────────────────────────────────────────────────┐
│              Веб-интерфейс (FastAPI)                 │
│                http://localhost:8080                 │
└────────────────────┬─────────────────────────────────┘
                     │
                     ↓
┌──────────────────────────────────────────────────────┐
│         ConfigManager (configs/channels_config.json) │
└────────────────────┬─────────────────────────────────┘
                     │
                     ↓
┌──────────────────────────────────────────────────────┐
│        MultiChannelJobMonitorBot (Telethon)          │
└─────────────┬──────────────────────┬─────────────────┘
              │                      │
              ↓                      ↓
      ┌──────────────┐      ┌──────────────┐
      │ Input Sources│      │Output Channels│
      │              │      │               │
      │ @channel1    │      │ Channel A     │
      │ @channel2    │──────│ Channel B     │
      │ @channel3    │      │ Channel C     │
      └──────────────┘      └──────────────┘
```

## 📦 Установка

### 1. Клонирование и зависимости

```bash
cd job_notification_bot
pip install -r requirements.txt
```

### 2. Настройка .env

Создайте файл `.env`:

```env
API_ID=your_api_id
API_HASH=your_api_hash
PHONE=your_phone_number
```

### 3. Создание директорий

```bash
mkdir -p logs configs
```

## 🚀 Запуск

### Способ 1: Через скрипт (рекомендуется)

```bash
chmod +x start_multi.sh
./start_multi.sh
```

### Способ 2: Напрямую

```bash
python3 main_multi.py
```

### Доступ к веб-интерфейсу

Откройте браузер: **http://localhost:8080**

## 📖 Использование

### 1. Создание первого канала

1. Откройте веб-интерфейс
2. Нажмите **"Добавить канал"**
3. Заполните форму:
   - **Название:** например, "Python вакансии"
   - **Telegram ID:** ID канала куда слать уведомления (получить через @getmyid_bot)
   - **Источники:** список каналов для мониторинга (по одному на строку)
   - **Включающие фильтры:** ключевые слова (python, django, flask)
   - **Исключающие фильтры:** слова для отсеивания (junior, стажер)
4. Нажмите **"Создать канал"**

### 2. Мониторинг работы

- Логи: `logs/bot_multi.log`
- Конфигурация: `configs/channels_config.json`
- Статистика: веб-интерфейс, раздел "Статистика"

## 🎨 Примеры конфигураций

### Пример 1: Python Senior/Middle

**Источники:**
```
@python_jobs
@django_jobs
@backend_jobs
```

**Включающие фильтры:**
```
python
django
flask
fastapi
senior
middle
```

**Исключающие фильтры:**
```
junior
стажер
trainee
```

### Пример 2: Remote JavaScript

**Источники:**
```
@js_jobs
@frontend_jobs
@remote_jobs
```

**Включающие фильтры:**
```
javascript
react
vue
node.js
remote
удаленно
```

**Исключающие фильтры:**
```
офис
office
релокация
```

### Пример 3: FB/IG Таргетологи

**Источники:**
```
@smm_jobs
@marketing_jobs
```

**Включающие фильтры:**
```
facebook
instagram
таргет
fb ads
meta
```

**Исключающие фильтры:**
```
google
yandex
tiktok
```

## 🔧 API

### REST API Endpoints

```http
GET    /api/channels           # Список всех каналов
GET    /api/channels/{id}      # Получить канал
POST   /api/channels           # Создать канал
PUT    /api/channels/{id}      # Обновить канал
DELETE /api/channels/{id}      # Удалить канал
GET    /api/stats              # Статистика
```

Подробнее в [WEB_INTERFACE_GUIDE.md](WEB_INTERFACE_GUIDE.md)

## 📁 Структура проекта

```
job_notification_bot/
├── bot_multi.py              # Бот с multi-channel поддержкой
├── config_manager.py         # Управление конфигурацией
├── main_multi.py            # Точка входа
├── web/                     # Веб-интерфейс
│   ├── app.py              # FastAPI приложение
│   ├── templates/          # HTML шаблоны
│   │   ├── channels_list.html
│   │   └── channel_edit.html
│   └── static/             # CSS и JS
│       └── style.css
├── configs/                # Конфигурационные файлы
│   └── channels_config.json
├── logs/                   # Логи
│   └── bot_multi.log
├── bot.py                  # Оригинальный бот (legacy)
├── config.py
├── database.py
├── message_processor.py
└── requirements.txt
```

## 🔄 Миграция с обычной версии

### Если у вас уже работает обычная версия:

1. **Сохраните текущую конфигурацию** (`channels.txt`, `.env`)
2. **Установите новые зависимости:**
   ```bash
   pip install -r requirements.txt
   ```
3. **Создайте первый канал через веб-интерфейс** с теми же параметрами
4. **Запустите новую версию:**
   ```bash
   ./start_multi.sh
   ```

Обычная версия продолжит работать параллельно, если нужно.

## 🛠️ Устранение неполадок

### Бот не запускается

1. Проверьте `.env` файл
2. Убедитесь что установлены все зависимости
3. Проверьте логи: `logs/bot_multi.log`

### Уведомления не приходят

1. Проверьте что канал активен в веб-интерфейсе
2. Убедитесь что бот имеет доступ к output каналу
3. Проверьте фильтры - они могут быть слишком строгими

### Веб-интерфейс недоступен

1. Проверьте что порт 8080 свободен: `lsof -i :8080`
2. Убедитесь что FastAPI запущен
3. Попробуйте другой порт в `web/app.py`

## 📚 Документация

- [WEB_INTERFACE_GUIDE.md](WEB_INTERFACE_GUIDE.md) - Полное руководство по веб-интерфейсу
- [PROJECT_SUMMARY.md](PROJECT_SUMMARY.md) - Описание оригинальной версии
- [QUICKSTART.md](QUICKSTART.md) - Быстрый старт

## 🔐 Безопасность

⚠️ **Важно:**

- Веб-интерфейс НЕ имеет аутентификации
- Не открывайте порт 8080 в интернет
- Используйте только в локальной сети или через SSH tunnel
- Регулярно делайте бэкапы `configs/channels_config.json`

### SSH Tunnel для удаленного доступа:

```bash
ssh -L 8080:localhost:8080 user@your-server
```

Затем открывайте `http://localhost:8080` на своем компьютере.

## 📊 Мониторинг и аналитика

### Логи

```bash
# Следить за логами в реальном времени
tail -f logs/bot_multi.log

# Поиск ошибок
grep ERROR logs/bot_multi.log

# Статистика отправленных уведомлений
grep "Уведомление отправлено" logs/bot_multi.log | wc -l
```

### База данных

Все сообщения сохраняются в `data/jobs.db` (SQLite).

```bash
sqlite3 data/jobs.db "SELECT COUNT(*) FROM jobs WHERE is_relevant = 1;"
```

## 🆚 Сравнение версий

| Функция | Обычная версия | Multi-Channel |
|---------|----------------|---------------|
| Output каналы | 1 | Неограниченно |
| Веб-интерфейс | ❌ | ✅ |
| Фильтры на канал | Глобальные | Индивидуальные |
| API | ❌ | ✅ REST API |
| Статистика | В логах | В веб-интерфейсе |

## 🤝 Вклад

Если нашли баг или хотите предложить улучшение:

1. Создайте issue с описанием
2. Или сразу pull request с фиксом

## 📝 Лицензия

MIT License

## 👨‍💻 Автор

Created with ❤️ for efficient job hunting

---

**Версия:** 2.0.0  
**Дата релиза:** Ноябрь 2024  
**Статус:** ✅ Production Ready

